<!doctype html><html lang=en dir=auto data-theme=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=8322&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Regex to match executing a stored procedure within a stored procedure | Bruno Garcia</title><meta name=keywords content="Regex,SQL"><meta name=description content="Using regex to find and match stored procedure calls nested inside other stored procedures in SQL Server."><meta name=author content="Bruno Garcia"><link rel=canonical href=http://localhost:8322/posts/2013/regex-to-match-executing-stored/><link crossorigin=anonymous href=/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css integrity="sha256-2jIR5e+Ge/K3X9WmUVz+1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:8322/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:8322/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:8322/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:8322/apple-touch-icon.png><link rel=mask-icon href=http://localhost:8322/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:8322/posts/2013/regex-to-match-executing-stored/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><link href=http://localhost:8322/css/custom.min.94d61a4faa677b041a8c9b05ce33e529d1a58a009e5c79583e31ec6b7e2cd50b.css integrity="sha256-lNYaT6pnewQajJsFzjPlKdGligCeXHlYPjHsa34s1Qs=" rel="preload stylesheet" as=style><script src=https://browser.sentry-cdn.com/10.39.0/bundle.tracing.min.js crossorigin=anonymous></script><script>Sentry.init({dsn:"https://88e8d79d263e44f0b6e3c3745244ce9c@o117736.ingest.sentry.io/5778766",integrations:[Sentry.browserTracingIntegration()],tracesSampleRate:1})</script><meta property="og:url" content="http://localhost:8322/posts/2013/regex-to-match-executing-stored/"><meta property="og:site_name" content="Bruno Garcia"><meta property="og:title" content="Regex to match executing a stored procedure within a stored procedure"><meta property="og:description" content="Using regex to find and match stored procedure calls nested inside other stored procedures in SQL Server."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2013-02-16T17:55:00+01:00"><meta property="article:modified_time" content="2013-02-16T17:55:00+01:00"><meta property="article:tag" content="Regex"><meta property="article:tag" content="SQL"><meta property="og:image" content="https://brunogarcia.com/assets/img/cover.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://brunogarcia.com/assets/img/cover.jpg"><meta name=twitter:title content="Regex to match executing a stored procedure within a stored procedure"><meta name=twitter:description content="Using regex to find and match stored procedure calls nested inside other stored procedures in SQL Server."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:8322/posts/"},{"@type":"ListItem","position":2,"name":"Regex to match executing a stored procedure within a stored procedure","item":"http://localhost:8322/posts/2013/regex-to-match-executing-stored/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Regex to match executing a stored procedure within a stored procedure","name":"Regex to match executing a stored procedure within a stored procedure","description":"Using regex to find and match stored procedure calls nested inside other stored procedures in SQL Server.","keywords":["Regex","SQL"],"articleBody":"Unless you’re working with a custom string format, which requires you writing a regular expression, I suppose (suggest?) you’ll look it up online, right?\nIf you need a Regex to match an IP, MAC or an E-mail, would you spend time writing it? Chances are that you might leave room for false positives and/or false negatives, unless you really test it. That’s why it’s common to look it up online.\nI needed to take a list of proc names and parse thousands of create procedure scripts, looking up if anything from the input list was used (executed) from those procs. A procedure executing another procedure.\nThis kind of call can be made in several different ways. It might have or not the database name (cross db call), server name (linked server), it might have or not the EXEC/EXECUTE keyword. It might have or not brackets or set the result to a variable.\nSince I looked it up and couldn’t find it, I wrote it. In case you need it, here you go:\n^\\s*((exec(ute)?)\\s+)?(@\\w+\\s+=\\s+)?((\\[?\\w+\\]?\\[.]{1,2}){1,3})?\\[?p_storedProcedure\\]?\\s.*$ Note that if you use SQL Server with default collation, proc names are case insensitive. So make sure you let your Regex engine know it should ignore cases! Otherwise you’ll have to mind the case of the EXEC/EXECUTE keywords anyway.\nAlso note that cross database and linked server calls will also match. Some examples of valid proc calls (that will match against the Regex) are:\np_storedProcedure -- comments p_storedProcedure @id, @anotherParam [p_storedProcedure] @id, @anotherParam EXEC p_storedProcedure @id, @anotherParam EXECUTE p_storedProcedure @id, @anotherParam EXEC p_storedProcedure EXEC p_storedProcedure -- comments EXEC [p_storedProcedure] @id, @anotherParam EXEC dbo.p_storedProcedure @id, @anotherParam EXEC dbo.[p_storedProcedure] @id, @anotherParam EXEC anySchema.[p_storedProcedure] @id, @anotherParam EXECUTE dbo.[p_storedProcedure] @id, @anotherParam EXEC [dbo].[p_storedProcedure] @id, @anotherParam EXEC [dbo].p_storedProcedure @id, @anotherParam EXEC DBTEST..p_storedProcedure @id, @anotherParam EXEC DBTEST..[p_storedProcedure] EXEC DBTEST.dbo.p_storedProcedure @id, @anotherParam EXEC [DBTEST]..[p_storedProcedure] @id, @anotherParam EXEC [DBTEST]..p_storedProcedure @id, @anotherParam EXEC [DBTEST].[dbo].[p_storedProcedure] @id, @anotherParam EXEC [LINKEDDATABASE].[DBTEST].[dbo].[p_storedProcedure] @id, @anotherParam EXEC LINKEDDATABASE.DBTEST.dbo.p_storedProcedure @id, @anotherParam EXEC LINKEDDATABASE.DBTEST..p_storedProcedure @id, @anotherParam EXEC @paramName = [dbo].[p_storedProcedure] @id, @anotherParam EXEC @paramName = dbo.p_storedProcedure EXEC @paramName = p_storedProcedure @id, @anotherParam EXECUTE @paramName = p_storedProcedure @id, @anotherParam EXECUTE @paramName = p_storedProcedure @id, @anotherParam ","wordCount":"351","inLanguage":"en","image":"https://brunogarcia.com/assets/img/cover.jpg","datePublished":"2013-02-16T17:55:00+01:00","dateModified":"2013-02-16T17:55:00+01:00","author":{"@type":"Person","name":"Bruno Garcia"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:8322/posts/2013/regex-to-match-executing-stored/"},"publisher":{"@type":"Person","name":"Bruno Garcia","logo":{"@type":"ImageObject","url":"http://localhost:8322/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=http://localhost:8322/ accesskey=h title="Bruno Garcia (Alt + H)">Bruno Garcia</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:8322/projects/ title=Projects><span>Projects</span></a></li><li><a href=http://localhost:8322/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Regex to match executing a stored procedure within a stored procedure</h1><div class=post-description>Using regex to find and match stored procedure calls nested inside other stored procedures in SQL Server.</div><div class=post-meta><span title='2013-02-16 17:55:00 +0100 +0100'>February 16, 2013</span>&nbsp;·&nbsp;<span>2 min</span>&nbsp;·&nbsp;<span>Bruno Garcia</span></div></header><div class=post-content><p>Unless you&rsquo;re working with a custom string format, which requires you writing a regular expression, I suppose (suggest?) you&rsquo;ll look it up online, right?</p><p>If you need a Regex to match an <a href=https://web.archive.org/web/20250722150414/http://answers.oreilly.com/topic/318-how-to-match-ipv4-addresses-with-regular-expressions/>IP</a>, <a href=http://stackoverflow.com/questions/4260467/what-is-a-regular-expression-for-a-mac-address>MAC</a> or an <a href=http://www.regular-expressions.info/email.html>E-mail</a>, would you spend time writing it? Chances are that you might leave room for false positives and/or false negatives, unless you <strong>really</strong> test it. That&rsquo;s why it&rsquo;s common to look it up online.</p><p>I needed to take a list of proc names and parse thousands of <em>create procedure</em> scripts, looking up if anything from the input list was used (executed) from those procs. <strong>A procedure executing another procedure.</strong></p><p>This kind of call can be made in several different ways. It might have or not the database name (cross db call), server name (linked server), it might have or not the <code>EXEC</code>/<code>EXECUTE</code> keyword. It might have or not brackets or set the result to a variable.</p><p>Since I looked it up and couldn&rsquo;t find it, I wrote it.
In case you need it, here you go:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-fallback data-lang=fallback><span style=display:flex><span>^\s*((exec(ute)?)\s+)?(@\w+\s+=\s+)?((\[?\w+\]?\[.]{1,2}){1,3})?\[?p_storedProcedure\]?\s.*$
</span></span></code></pre></div><p>Note that if you use SQL Server with default collation, <a href=http://stackoverflow.com/questions/508739/are-sql-stored-procedures-case-sensitive>proc names are case insensitive</a>. So make sure you let your Regex engine know it should <strong>ignore cases</strong>! Otherwise you&rsquo;ll have to mind the case of the <code>EXEC</code>/<code>EXECUTE</code> keywords anyway.</p><p>Also note that cross database and <a href=http://msdn.microsoft.com/en-us/library/ms188279.aspx>linked server</a> calls will also match. Some examples of valid proc calls (that will match against the Regex) are:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-sql data-lang=sql><span style=display:flex><span>p_storedProcedure <span style=color:#6272a4>-- comments
</span></span></span><span style=display:flex><span>p_storedProcedure <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span>[p_storedProcedure] <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXEC</span> p_storedProcedure <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXECUTE</span> p_storedProcedure <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXEC</span> p_storedProcedure
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXEC</span> p_storedProcedure <span style=color:#6272a4>-- comments
</span></span></span><span style=display:flex><span><span style=color:#ff79c6>EXEC</span> [p_storedProcedure] <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXEC</span> dbo.p_storedProcedure <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXEC</span> dbo.[p_storedProcedure] <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXEC</span> anySchema.[p_storedProcedure] <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXECUTE</span> dbo.[p_storedProcedure] <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXEC</span> [dbo].[p_storedProcedure] <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXEC</span> [dbo].p_storedProcedure <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXEC</span> DBTEST..p_storedProcedure <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXEC</span> DBTEST..[p_storedProcedure]
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXEC</span> DBTEST.dbo.p_storedProcedure <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXEC</span> [DBTEST]..[p_storedProcedure] <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXEC</span> [DBTEST]..p_storedProcedure <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXEC</span> [DBTEST].[dbo].[p_storedProcedure] <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXEC</span> [LINKEDDATABASE].[DBTEST].[dbo].[p_storedProcedure] <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXEC</span> LINKEDDATABASE.DBTEST.dbo.p_storedProcedure <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXEC</span> LINKEDDATABASE.DBTEST..p_storedProcedure <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXEC</span> <span style=color:#ff79c6>@</span>paramName <span style=color:#ff79c6>=</span> [dbo].[p_storedProcedure] <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXEC</span> <span style=color:#ff79c6>@</span>paramName <span style=color:#ff79c6>=</span> dbo.p_storedProcedure
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXEC</span> <span style=color:#ff79c6>@</span>paramName <span style=color:#ff79c6>=</span> p_storedProcedure <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXECUTE</span> <span style=color:#ff79c6>@</span>paramName <span style=color:#ff79c6>=</span> p_storedProcedure <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXECUTE</span>    <span style=color:#ff79c6>@</span>paramName     <span style=color:#ff79c6>=</span>     p_storedProcedure     <span style=color:#ff79c6>@</span>id, <span style=color:#ff79c6>@</span>anotherParam
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:8322/tags/regex/>Regex</a></li><li><a href=http://localhost:8322/tags/sql/>SQL</a></li></ul></footer></article></main><footer class=footer><div class=footer-projects>hobby projects:
<a href=https://codereviewtrends.com target=_blank rel=noopener>Code Review Trends</a>
·
<a href=https://nugettrends.com target=_blank rel=noopener>NuGet Trends</a></div><span>&copy; 2026 <a href=https://github.com/bruno-garcia/blog target=_blank rel=noopener>Bruno Garcia</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>